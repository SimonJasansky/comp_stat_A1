---
title: "Assignment 1"
author: "Akos Engelmann, Gergely Paradi, Fabian Gallyas, Ipek Cakin, Simon Jasansky"
date: "2023-03-05"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("ggplot2")

```


# Load Data
```{r, include=FALSE}
a1_data <- read_csv("a1_data.csv")
print(a1_data)

ggplot(pivot_longer(a1_data, everything()), aes(value)) +
geom_histogram(bins = 100) +
facet_wrap(~name, nrow = 3)

```





## Define the assumptions that you would like to make.
- There is a causal relationship between the variables
- The causal relationship (i.e. the graph) is acyclic and with no self-loops 

If we use Park algorithm: 
- model is additive noise model
- $\epsilon_1$, $\epsilon_2$ etc. are independent, uniformly distributed with mean 0 and variance $\sigma^2$, and all of the epsilons have to have the same variance. 

However, we cannot assume that the variables themselves are normally distributed! (e.g. look at variable D)


## Develop a procedure to estimate the DAG from the data using your assumptions.

```{r}
# test the procedure: ranking by variance and then do pairwise correlation tests:

variances <- a1_data %>% summarise(var)
variances

as.numeric(variances[1,])

variances_df = tibble("vars" = variances %>% names(), "variance" = as.numeric(variances[1,]))

variances_df %>% arrange(variance, decreasing = TRUE)

```



## Implement your procedure in R or Python and report your DAG




## Explain what the limits of your procedure are, both statistically and in terms of possible violations of your assumption with real world data

The DAG procedure assumes that there is a causal relationship between the variables, that the causal relationship is acyclic and has no self-loops, and that the errors follow an additive noise model with uniform, independent errors. Violations of these assumptions can lead to biased estimates of the causal relationships. 
	
The DAG procedure assumes that the causal direction is known and that the causal ordering is correct. In practice, it was difficult to determine the correct causal ordering, and it may be necessary to use multiple methods to identify the causal direction.

Given identifiability condition could be very restrictive, even if it is very general version of the conditions for linear structural equation models (SEMs).
	
Additionally, Additive Noise Models (ANMs) are statistical consistency of learning non-linear have been not provided yet.

The DAG procedure can identify correlations between variables, but it does not necessarily identify causal relationships. Careful interpretation of the results is necessary to determine whether the relationships identified by the DAG procedure are truly causal.

Furthermore, Real-world data often includes confounding variables, which can complicate the estimation of causal relationships. And also, the assumptions of the DAG procedure may not hold for all types of data, such as data that include discrete variables or time-varying relationships.

Reference:
Park, Gunwoong. 2020. “Identifiability of Additive Noise Models Using Conditional Variances.” Journal of Machine Learning Research 21 (75): 1–34. http://jmlr.org/papers/v21/19-664.html.


